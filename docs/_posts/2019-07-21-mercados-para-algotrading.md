---
layout: post
title: Mercados para algotrading
tags: mercados, bolsa, forex, criptomoedas, regulação
youtubeId: jWNrrXiTTw4
---

Hoje em dia existem diversos mercados para realizar investimentos e trading. O mundo dos investimentos não está mais restrito ao banco próximo de sua casa, em grande parte graças à tecnologia e à abertura dos mercados. Nem todo ativo com o qual se faz trading é um ativo de investimento. De toda forma, em todos os mercados pode-se fazer trading com seus ativos.

No que diz respeito a mercados, pode-se escolher entre bolsas de valores (incluem-se as de mercadorias e futuros), forex e criptomoedas. Esse artigo apresenta brevemente cada um desses mercados, e traz elementos a serem considerados pelo ponto de vista do algotrader.

## 1. Mercados

### 1.1 Bolsas de valores 

As bolsas de valores são mercados centralizados, ou seja, todos os participantes realizam suas negociações de compra e venda centralizada na bolsa, e os clientes de todas as corretoras têm, em tese, acesso ao mesmo livro de ofertas. São exemplos de bolsas de valores a [B3](http://www.b3.com.br), que é a antiga Bovespa e principal bolsa de valores do Brasil, sabendo que há bolsas regionais específicas para mercadorias. 

A B3 está entre as [20 maiores bolsas do mundo](https://www.bussoladoinvestidor.com.br/maiores-bolsas-de-valores-do-mundo/), em termos de valor de mercado dos ativos sendo negociados. As três maiores são a [New York Stock Exchange (NYSE)](https://www.nyse.com), a [Nasdaq](https://www.nasdaq.com/), e a [London Stock Exchange (LSE)](https://www.londonstockexchange.com). A negociação de ativos nas bolsas de valores é intermediada por bancos e corretoras. No caso da B3, a listagem de agentes de intermediação pode ser obtida no seguinte endereço: [busca de corretoras](http://www.b3.com.br/pt_br/produtos-e-servicos/participantes/busca-de-participantes/busca-de-corretoras/).

Os horários de negociação das bolsas seguem horas locais. O envio de ordens é feito apenas nesses horários. No caso da B3, corretoras e plataformas que permitem agendamento de ordens as retém em seus sistemas para envio à bolsa durante o horário de pregão. Geralmente ordens agendadas são configuradas para serem enviadas na abertura ou no fechamento do pregão, quando ocorrem os respectivos leilões.


### 1.2 Foreign Exchange (Forex)

O mercado de Forex é descentralizado, sendo que cada *exchange* estabelece seus horários de funcionamento. Ou seja, não existe uma "bolsa" de forex, mas cada corretora estabelece seus participantes, dentre eles os chamados de fornecedores de liquidez, que em geral são grandes instituições. O que se negocia são pares de moedas, como por exemplo o par EUR/USD (Euro-Dolar). Quando se faz uma operação de compra de EUR/USD, se compra Euros e se vende Dolar, simultaneamente. No entanto, não se está efetivamente comprando as moedas, mas entrando numa operação que financeiramente se comportará como se tivesse havido a negociação das moedas correspondentes. Ou seja, é uma operação de derivativos, pois o preço é derivado de preços de outros ativos de câmbio.

O mercado de forex funciona 24h por dia, tendo liquidez por quase todos os sete dias da semana. Isso porque há *exchanges* em todo o mundo, e algumas moedas são mais negociadas num lado do planeta, e outras no outro lado. Por exemplo, os pares AUD/USD e USD/JPY são mais negociados em horários em que a Austrália e Japão estão em horário local comercial. Nesse períodos, na América e Europa, há menos movimento de pares envolvendo dolar e Euro. É um mercado que movimenta trilhões de dolares por dia, sendo portanto bastante relevante.

As *exchanges* cobram pelos seus serviços de duas formas: cobrando taxa fixa por ordem ou aumentando o spread (diferença entre o preço apresentado para o trader e o preço do provedor de liquidez. O algotrader precisa observar bem esses aspectos. 

### 1.3 Criptomoedas

As criptomoedas foram criadas após a crise de subprimes, em 2008. Isso se deu com o lançamento do Bitcoin. Desde então, várias outras moedas foram criadas, assim como as mais diferentes formas de se ganhar dinheiro com elas. O mercado de criptomoedas é também descentralizado, com as *exchanges* sendo o meio pelo qual se faz negociação.

É um mercado considerado bastante volátil, que tem atraído cada vez mais adeptos. Como é um mercado bastante tecnológico, há também corretoras como APIs para negociação. No entanto, a liquidez precisa ser avaliada. Por exemplo, dados recentes apontam que o montante financeiro negociado diariamente em Bitcoins em todo o mundo até pouco tempo era equivalente ao que se negocia na B3, no Brasil. Com a maior procura por criptoativos, a movimentação diária tem aumentado. Mas poucas criptomoedas possuem boa liquidez. A depender do algoritmo de trading, liquidez é essencial. Isso porque ativos de baixa liquidez podem ser facilmente manipulados.

Nesse mercado os custos podem ser relevantes, principalmente para realização de saques.

## 2. A importância da regulação

O trader precisa estar ciente das regras do jogo. Entre elas estão as condições impostas por orgãos reguladores. 

Um exemplo é o mercado de forex. Esse mercado não é regulado no Brasil, e corretoras do exterior são proibidas de realizar captação de clientes em território nacional. Por outro lado, não é proibido que brasileiros residentes abram uma conta no exterior e realizem operações no mercado de forex. 

A CVM possui [cartilhas sobre forex e criptoativos](https://www.investidor.gov.br/publicacao/Alertas/listaalertas.html). O Trader que busca esses mercados fora do Brasil, por qualquer que seja sua razão, deve estar ciente dos riscos, e a CVM nada poderá fazer por você. Mas isso não quer dizer que *exchanges* vivem em um mundo sem lei. Há mercados regulados, como em grandes capitais do mundo, assim como no Brasil.  

Se o trader decidir operar com esses ativos, recomenda-se buscar mercados regulados. Sim, os custos são maiores, até mesmo porque as *exchanges* são controladas por orgãoes ficalizadores e audidatas. Há quem não goste desse controle externo, mas em se tratando do nosso dinheiro, se precaver pode sair mais barato do que remediar. Em mercados não regulados, não sabemos se a contra-parte é a própria *exchange*, que identifica um trader que perde consistentemente. Ou seja, entra aí um problema de conflito de interesses. O excesso de alavancagem contribui para tais perdas, se não for considerado pelo trader no seu gerenciamento de risco. Há relatos em foruns de *exchanges* que dificultam o resgate de recursos. Mais recentemente, o Banco Central Europeu proibiu a negociação de opções binárias naquele continente.

Logo, o problema não é tanto com esses mercados, mas ele pode estar sim com a corretora. Por isso o trader precisa fazer a devida diligência para fazer sua escolha. 

Isso não significa que a operação em bolsas de valores também não tenha problema. Claro que existem todos os riscos inerentes desse mercado, inclusive de a corretora fechar as portas. No caso do Brasil, já aconteceu isso. Como a custódia não é na corretora, não há problema. O problema pode ser receber de volta o dinheiro parado em conta corrente. Isso faz com que o trader busque manter poucos recursos parados em conta corrente, ou mesmo fazer mais uso das garantias providas por suas posições, que podem até mesmo ser em títulos de renda fixa de alta liquidez.


## 3. Aspectos tecnológicos

Agora, vendo apenas sob a ótica de algotrading, os aspectos de tecnologias e disponibilidade de dados são muito importantes, além, claro, da regulação, debatida acima. Sob esses aspectos, a questão do mercado algo é menos relevante.

Primeiro, do ponto de vista de tecnologia, até o momento, o trader brasileiro conta com poucas facilidades para operação na B3. Isso não nos impede de operar, de forma lucrativa, com a B3. Mas podia ter serviços como encontrados em corretoras de grandes bolsas mundiais. Fala-se por exemplo de APIs de dados e de negociação. Sem esse tipo de serviço aqui no país, a negociação deve ser feita por meio de home brokers e plataformas de terceiros. Na verdade existem empresas que produzem softwares com essas características, mas são direcionados ao grande investidor e fundos de investimento, pelo custo.

Os home brokers são feitos para serem operados por pessoas, e não máquinas. Logo, toda interface é por meio de teclado e mouse. Isso significa que a melhor automação que pode ser feita é por meio de bibliotecas de manipulação dessas interfaces. Mesmo assim, a lentidão dessas interfaces as destina a operações para as quais uns 15s de tempo de preenchimento de uma boleta não atrapalhe o resultado. Para os swing traders, isso não é um real problema.

<br/>
{% include youtube-player.html id=page.youtubeId %}
<br/>

Com relação às plataformas de negociação, Metatrader apresenta excelentes capacidades de interface com outros programas (por meio de sockets) ou de execução de código programado em sintaxe C/C++. Outros fabricantes nacionais estão abrindo suas plataformas para permitir trading algorítmico, ou propõem plataformas específicas para robôs de negociação. Vale a pena acompanhar essa evolução. Nós esperamos uma maior disponibilidade de recursos para algotraders nos próximos anos.

No âmbito internacional, já existe uma grande variedade de corretoras e exchanges que são amigáveis a algotrading. Essas corretoras disponibilizam APIs, plataformas e tecnologia para algotraders. E isso tanto para bolsas de valores como para forex e  criptoativos. Uma breve busca no Google já mostra como está esse universo. 


## 4. Disponibilidade de dados

O algotrader precisa de dados para realiza backtesting e análise walkforward. Plataformas como o Metatrader possuem embutido a capacidade de buscar dados do mercado e salvar em arquivos. 

No caso da B3, há empresas que fornecem dados históricos ajustados e não-ajustados. No entanto, pelo que pudemos constatar, é necessário contatar a empresa para ser informado do preço. Como o algotrader precisa ter sua base constantemente atualizada, a compra de bases históricas somente faz sentido se for possível atualizá-la frequentemente. Isso porque dificilmente um algoritmo de trading se mantém rentável em quaisquer condições de mercado. Como elas mudam constantemente, dispor de dados atualizados é essencial.

Há fontes gratuitas de dados, que demandam um trabalho de construção de um script de captura. Geralmente essas fontes são atrasadas, de pelo menos 15 min. Um exemplo é a base de dados históricos da B3, que é atualizada após as 20:00. Observamos dias que, no entanto, a atualização ocorreu bem mais tarde. Há a possobilidade também de se obter cotações ajustadas dos sites Yahoo Finance e Google Finance, embora haja uma boa discussão sobre a confiabilidade desses dados.

No caso de bolsas mundiais, como NYSE e NASDAQ, há uma boa disponibilidade de dados, inclusive gratuitos. É o caso do serviço [Quandl](https://www.quandl.com/) e [Alpha Vantage](https://www.alphavantage.co/). 

No caso de *exchanges* de forex e de criptoativos, cada uma decide fornecer ou não dados históricos.

Uma questão ligada à obtenção de dados históricos é a lista de códigos (ou *symbols*) dos ativos, prinipalmente para bolsas de valores. Nesse [link](https://github.com/prediqtiv/alpha-vantage-cookbook/blob/master/symbol-lists.md) há referências a fontes de listas de códigos para diferentes bolsas mundiais. No caso da B3, o mais fácil é obter a listagem a partir da [lista de papéis que compõem os índices da bolsa](http://www.b3.com.br/pt_br/market-data-e-indices/indices/acoes-por-indice/). Para a lista completa de ativos em negociação, um caminho consiste em processar as páginas de [títulos negociáveis](http://www.b3.com.br/pt_br/market-data-e-indices/servicos-de-dados/market-data/consultas/mercado-a-vista/titulos-negociaveis/).


## 5. Conclusões

O algotrader encontra cada vez mais espaço para desenvolvimento de suas estratégias. Quer seja bolsa de valores, forex ou criptoativos, o algotrader precisa conhecer bem sobre aquele mercado e ter uma boa noção dos riscos envolvidos. Com isso em mente, poderá desenvolver estratégias que são rentáveis. Em conjunto com uma boa gestão de risco, que é o que trará consistência e resiliência, tem-se uma conjunção de elementos a seu favor.

Esse texto menciona muito sobre riscos. Parece até que o melhor é deixar seu dinheiro aplicado na própria poupança em um grande banco. Mas será mesmo que não existe risco em fazer isso? 


